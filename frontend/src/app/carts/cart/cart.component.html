<div class="cart-container">
    <div class="cart-payment-container">
        <mat-card>
            <mat-card-header>
                <mat-card-title>Total a pagar:</mat-card-title>
                <mat-card-title>{{total | currency: 'EUR':'symbol'}}</mat-card-title>
            </mat-card-header>
            <mat-card-actions>
                <button mat-raised-button color="primary" type="button" (click)="checkout()" [disabled]="!cartValid">PAGAR</button>
            </mat-card-actions>
            <button (click)="test()">Test</button>
        </mat-card>
    </div>
    <mat-card class="empty-cart" *ngIf="cartItems.length === 0">
        <mat-card-header>
            <mat-card-title>
                No hay productos en el carrito
            </mat-card-title>
        </mat-card-header>
        <mat-card-actions>
            <button mat-raised-button color="primary" routerLink="/">Comprar</button>
        </mat-card-actions>
    </mat-card>
    <mat-card *ngIf="cartItems.length > 0">
            <mat-card-content>
                <div *ngIf="!selectedAddress" class="select-address-container">
                    <form>
                        <mat-form-field>
                            <mat-label>Seleccione una dirección de envío</mat-label>
                            <mat-select [formControl]="selectAddress" >
                                <!-- <mat-option value="0">Ninguna</mat-option> -->
                                <mat-option *ngFor="let address of addresses" [value]="address.id">
                                    {{address.street}}, {{address.city}}, {{address.postalCode}}, {{address.country}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </form>
                </div>
                <div class="cart-info-container">
                    <mat-card *ngIf="selectedAddress" class="address-card">
                        <mat-card-header>
                            <mat-card-title>Dirección de envío</mat-card-title>
                        </mat-card-header>
                        <mat-card-content>
                            <ul>
                                <li>{{selectedAddress.street}}</li>
                                <li>{{selectedAddress.city}}</li>
                                <li>{{selectedAddress.postalCode}}</li>
                                <li>{{selectedAddress.country}}</li>
                            </ul>
                        </mat-card-content>
                        <mat-card-actions>
                            <button mat-raised-button color="primary" (click)="setSelectedAddressToNull()" [disabled]="(addresses.length <= 1)">Cambiar</button>
                        </mat-card-actions>
                    </mat-card>
                    <mat-list class="cart-list" *ngFor="let cartItem of cartItems">
                        <app-cart-item-card (itemDeleted)="itemDeleted()" [cartItem]="cartItem"></app-cart-item-card>
                        <mat-divider [vertical]="true"></mat-divider>
                    </mat-list>
                </div>
            </mat-card-content>
    </mat-card>
</div>